<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Student Details Form</title>
<style>
  :root{--bg:#f6f8fb;--card:#fff;--accent:#0b5ed7;--muted:#6b7280;}
  body{font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:var(--bg);color:#111;}
  .container{max-width:900px;margin:32px auto;padding:24px;}
  .card{background:var(--card);border-radius:12px;box-shadow:0 6px 24px rgba(13,20,30,0.08);padding:22px;}
  h1{margin:0 0 12px;font-size:20px;}
  p.lead{margin:0 0 18px;color:var(--muted);}
  form{display:grid;grid-template-columns:repeat(2,1fr);gap:14px;}
  label{display:block;font-size:13px;margin-bottom:6px;color:#111;font-weight:600;}
  input[type="text"],input[type="email"],input[type="tel"],select,textarea,input[type="date"]{
    width:100%;padding:10px;border:1px solid #e6e9ef;border-radius:8px;font-size:14px;
  }
  textarea{min-height:80px;resize:vertical;}
  .full{grid-column:1/-1;}
  .actions{display:flex;gap:10px;align-items:center;margin-top:6px;}
  button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;}
  button.secondary{background:#f3f4f6;color:#111;border:1px solid #e6e9ef;}
  .small{font-size:13px;color:var(--muted);}
  .photo-preview{display:flex;gap:10px;align-items:center;margin-top:6px;}
  .photo-preview img{width:80px;height:80px;object-fit:cover;border-radius:8px;border:1px solid #e6e9ef;}
  table{width:100%;border-collapse:collapse;margin-top:18px;}
  th,td{padding:8px;border-bottom:1px solid #f0f0f2;font-size:13px;text-align:left;}
  @media (max-width:720px){form{grid-template-columns:1fr} .photo-preview img{width:60px;height:60px}}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h1>Student Details Form</h1>
    <p class="lead">Sahi aur complete details bharein. Har required field pe * laga hua hai.</p>

    <form id="studentForm" autocomplete="off">
      <div>
        <label>Full Name *</label>
        <input type="text" id="name" required placeholder="Ex: Rahul Kumar">
      </div>

      <div>
        <label>Roll / Registration No. *</label>
        <input type="text" id="roll" required placeholder="Ex: CSE2025/045">
      </div>

      <div>
        <label>Email *</label>
        <input type="email" id="email" required placeholder="you@example.com">
      </div>

      <div>
        <label>Phone *</label>
        <input type="tel" id="phone" required pattern="[0-9]{10}" placeholder="10-digit number">
      </div>

      <div>
        <label>Department *</label>
        <select id="dept" required>
          <option value="">-- Select Department --</option>
          <option>CSE</option><option>ECE</option><option>ME</option><option>CE</option><option>Other</option>
        </select>
      </div>

      <div>
        <label>Semester *</label>
        <select id="sem" required>
          <option value="">-- Select Semester --</option>
          <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option>
        </select>
      </div>

      <div>
        <label>Date of Birth</label>
        <input type="date" id="dob">
      </div>

      <div>
        <label>Gender</label>
        <select id="gender">
          <option value="">Prefer not to say</option><option>Male</option><option>Female</option><option>Other</option>
        </select>
      </div>

      <div class="full">
        <label>Address</label>
        <textarea id="address" placeholder="Permanent / Local address"></textarea>
      </div>

      <div>
        <label>Parent / Guardian Name</label>
        <input type="text" id="parent" placeholder="Ex: Sushma Devi">
      </div>

      <div>
        <label>Hobbies / Interests (comma separated)</label>
        <input type="text" id="hobbies" placeholder="Ex: Coding, Cricket, Music">
      </div>

      <div>
        <label>Upload Photo (optional)</label>
        <input type="file" id="photo" accept="image/*">
        <div class="photo-preview" id="previewArea"></div>
      </div>

      <div class="full actions">
        <button type="submit">Submit</button>
        <button type="button" id="clearBtn" class="secondary">Clear Form</button>
        <button type="button" id="downloadCsv" class="secondary">Download CSV</button>
        <div style="margin-left:auto" class="small" id="statusMsg">Saved entries: 0</div>
      </div>
    </form>

    <div id="submissionsList" style="margin-top:18px"></div>

  </div>
</div>

<script>
/* Simple client-side storage & CSV export. Brutally practical. */
const form = document.getElementById('studentForm');
const photoInput = document.getElementById('photo');
const previewArea = document.getElementById('previewArea');
const statusMsg = document.getElementById('statusMsg');
const downloadCsvBtn = document.getElementById('downloadCsv');
const clearBtn = document.getElementById('clearBtn');
const submissionsList = document.getElementById('submissionsList');

const STORAGE_KEY = 'student_form_submissions_v1';

function loadSubmissions() {
  const raw = localStorage.getItem(STORAGE_KEY);
  return raw ? JSON.parse(raw) : [];
}

function saveSubmissions(arr) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
  updateStatus();
  renderList();
}

function updateStatus() {
  const count = loadSubmissions().length;
  statusMsg.textContent = `Saved entries: ${count}`;
}

function renderList() {
  const arr = loadSubmissions();
  if (!arr.length) { submissionsList.innerHTML = '<p class="small">Koi submission nahi mila.</p>'; return; }
  let html = '<table><thead><tr><th>Name</th><th>Roll</th><th>Email</th><th>Phone</th><th>Dept</th><th>Sem</th></tr></thead><tbody>';
  arr.slice().reverse().forEach(s => {
    html += `<tr><td>${escapeHtml(s.name)}</td><td>${escapeHtml(s.roll)}</td><td>${escapeHtml(s.email)}</td><td>${escapeHtml(s.phone)}</td><td>${escapeHtml
